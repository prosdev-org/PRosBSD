cmake_minimum_required(VERSION 3.15)
set(CMAKE_C_COMPILER_WORKS ON)
set(CMAKE_CXX_COMPILER_WORKS ON)
project(PRosBSD LANGUAGES C CXX ASM VERSION 0.2.0)

set(PROJECT_VERSION_SUFFIX "-dev")
set(TARGET_ARCH "i386")

set(PROJECT_VERSION_FULL "${PROJECT_VERSION}${PROJECT_VERSION_SUFFIX}")

file(WRITE "${CMAKE_BINARY_DIR}/include/generated/version.h" "// This file is automatically generated, do not touch it. To bump version edit CMakeLists.txt.
#define VERSION_MAJOR ${PROJECT_VERSION_MAJOR}
#define VERSION_MINOR ${PROJECT_VERSION_MINOR}
#define VERSION_PATCH ${PROJECT_VERSION_PATCH}
#define VERSION_SUFFIX \"${PROJECT_VERSION_SUFFIX}\"
#define VERSION_STRING \"${PROJECT_VERSION_FULL}\"
")

file(WRITE "${CMAKE_BINARY_DIR}/include/generated/arch.h" "// This file is automatically generated, do not touch it. To bump architecture edit CMakeLists.txt.
#define TARGET_ARCH \"${TARGET_ARCH}\"
")

message(STATUS "${PROJECT_NAME} v.${PROJECT_VERSION_FULL} arch-${TARGET_ARCH}")

set(CMAKE_C_STANDARD 99)
set(CMAKE_C_STANDARD_REQUIRED ON)

include_directories(${CMAKE_BINARY_DIR}/include)

add_subdirectory(kernel)
